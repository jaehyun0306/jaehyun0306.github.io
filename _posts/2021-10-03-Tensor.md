---
title: "í…ì„œí”Œë¡œìš° ì†Œê°œ"
excerpt: "í…ì„œí”Œë¡œìš°ì˜ ë‚´ìš©ì„ ì •ë¦¬í•˜ê¸°"
toc: true
toc_sticky: true
---

# í…ì„œ

```python
import tensorflow as tf
import numpy as np
```

í…ì„œëŠ” ì¼ê´€ëœ ìœ í˜•(dtypeì´ë¼ê³  ë¶ˆë¦¬ëŠ”)ì„ ê°€ì§„ ë‹¤ì°¨ì› ë°°ì—´ì…ë‹ˆë‹¤.  
NumPyì— ìµìˆ™í•˜ë‹¤ë©´, í…ì„œëŠ” ì¼ì¢…ì˜ Numpy.arraysì™€ ê°™ìŠµë‹ˆë‹¤.  
ëª¨ë“  í…ì„œëŠ” Python ìˆ«ì ë° ë¬¸ìì—´ê³¼ ê°™ì´ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.  
í…ì„œì˜ ë‚´ìš©ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ì—†ìœ¼ë©° ìƒˆë¡œìš´ í…ì„œë¥¼ ë§Œë“¤ ìˆ˜ë§Œ ìˆìŠµë‹ˆë‹¤.

## ê¸°ì´ˆ
ê¸°ë³¸ í…ì„œë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.

ë‹¤ìŒì€ "ìŠ¤ì¹¼ë¼" ë˜ëŠ” "Rank-0" í…ì„œì…ë‹ˆë‹¤. ìŠ¤ì¹¼ë¼ëŠ” ë‹¨ì¼ ê°’ì„ í¬í•¨í•˜ë©° "ì¶•"ì€ ì—†ìŠµë‹ˆë‹¤.


```python
rank_0_tensor = tf.constant(4)
print(rank_0_tensor)
```

    tf.Tensor(4, shape=(), dtype=int32)  
    



"ë²¡í„°" ë˜ëŠ” "Rank-1" í…ì„œëŠ” ê°’ì˜ ëª©ë¡ê³¼ ê°™ìŠµë‹ˆë‹¤. ë²¡í„°ì—ëŠ” í•˜ë‚˜ì˜ ì¶•ì´ ìˆìŠµë‹ˆë‹¤.


```python
rank_1_tensor = tf.constant([2.0, 3.0, 4.0])
print(rank_1_tensor)
```

    tf.Tensor([2. 3. 4.], shape=(3,), dtype=float32)
    

"í–‰ë ¬" ë˜ëŠ” "Rank-2" í…ì„œì—ëŠ” ë‘ ê°œì˜ ì¶•ì´ ìˆìŠµë‹ˆë‹¤.


```python
rank_2_tensor = tf.constant([[1, 2], [3, 4], [5, 6]], dtype = tf.float16)
print(rank_2_tensor)
```

    tf.Tensor(
    [[1. 2.]
     [3. 4.]
     [5. 6.]], shape=(3, 2), dtype=float16)
    

"ìŠ¤ì¹¼ë¼", "ë²¡í„°", "í–‰ë ¬" í…ì„œì˜ í˜•íƒœ

![scalar.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EC%8A%A4%EC%B9%BC%EB%9D%BC.PNG)

í…ì„œì—ëŠ” ë” ë§ì€ ì¶•ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ì—¬ê¸°ì—ì„œëŠ” ì„¸ ê°œì˜ ì¶•ì´ ìˆëŠ” í…ì„œê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.


```python
rank_3_tensor = tf.constant([[[0, 1, 2, 3, 4], [5,6, 7, 8, 9]], 
                             [[10, 11, 12, 13, 14], [15, 16, 17, 18, 19]],
                             [[20, 21, 22, 23, 24], [25, 26, 27, 28, 29]]])
print(rank_3_tensor)
```

    tf.Tensor(
    [[[ 0  1  2  3  4]
      [ 5  6  7  8  9]]
    
     [[10 11 12 13 14]
      [15 16 17 18 19]]
    
     [[20 21 22 23 24]
      [25 26 27 28 29]]], shape=(3, 2, 5), dtype=int32)
    

ì¶•ì´ ë‘ ê°œ ì´ìƒì¸ í…ì„œë¥¼ ì‹œê°í™”í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.

![3ì¶•í…ì„œ.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/3%EC%B6%95%ED%85%90%EC%84%9C.PNG)

np.array ë˜ëŠ” tensor.numpy ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í…ì„œë¥¼ NumPyë°°ì—´ë¡œ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
np.array(rank_2_tensor)
```




    array([[1., 2.],
           [3., 4.],
           [5., 6.]], dtype=float16)




```python
rank_2_tensor.numpy()
```




    array([[1., 2.],
           [3., 4.],
           [5., 6.]], dtype=float16)



í…ì„œì—ëŠ” ì¢…ì¢… floatì™€ intê°€ í¬í•¨ë˜ì§€ë§Œ ë‹¤ìŒê³¼ ê°™ì€ ìœ í˜•ë„ ìˆìŠµë‹ˆë‹¤.
* ë³µì†Œìˆ˜
* ë¬¸ìì—´

ê¸°ë³¸ tf.Tensor í´ë˜ìŠ¤ì—ì„œëŠ” í…ì„œê°€ "ì§ì‚¬ê°í˜•"ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì¦‰ ê° ì¶•ì„ ë”°ë¼ ëª¨ë“  ìš”ì†Œì˜ í¬ê¸°ê°€ ê°™ìŠµë‹ˆë‹¤.  
ê·¸ëŸ¬ë‚˜ ë‹¤ì–‘í•œ í˜•ìƒì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” íŠ¹ìˆ˜ ìœ í˜•ì˜ í…ì„œê°€ ìˆìŠµë‹ˆë‹¤.
* ë¹„ì •í˜•
* í¬ì†Œ

ë§ì…ˆ, ìš”ì†Œë³„ ê³±ì…ˆ ë° í–‰ë ¬ ê³±ì…ˆì„ í¬í•¨í•˜ì—¬ í…ì„œì— ëŒ€í•œ ê¸°ë³¸ ì‚°ìˆ ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
a = tf.constant([[1, 2],
                 [3, 4]])
b = tf.constant([[1, 1],
                 [1, 1]])

print(tf.add(a,b), "\n")
print(tf.multiply(a, b), "\n")
print(tf.matmul(a, b), "\n")  # í–‰ë ¬ê³±
```

    tf.Tensor(
    [[2 3]
     [4 5]], shape=(2, 2), dtype=int32) 
    
    tf.Tensor(
    [[1 2]
     [3 4]], shape=(2, 2), dtype=int32) 
    
    tf.Tensor(
    [[3 3]
     [7 7]], shape=(2, 2), dtype=int32) 
    
    


```python
print(a + b, "\n")  #ë”í•˜ê¸°
print(a * b, "\n")  #ê³±í•˜ê¸°
print(a @ b, "\n")  #í–‰ë ¬ê³±
```

    tf.Tensor(
    [[2 3]
     [4 5]], shape=(2, 2), dtype=int32) 
    
    tf.Tensor(
    [[1 2]
     [3 4]], shape=(2, 2), dtype=int32) 
    
    tf.Tensor(
    [[3 3]
     [7 7]], shape=(2, 2), dtype=int32) 
    
    

í…ì„œëŠ” ëª¨ë“  ì¢…ë¥˜ì˜ ì—°ì‚°ì— ì‚¬ìš©ë©ë‹ˆë‹¤.


```python
c = tf.constant([[4.0, 5.0], [10.0, 1.0]])

#  ê°€ì¥ í° ê°’ ì°¾ê¸°
print(tf.reduce_max(c))
# ê°’ì´ ê°€ì¥ í° ì¸ë±ìŠ¤ ì°¾ê¸°
print(tf.argmax(c))
# ì†Œí”„íŠ¸ë§¥ìŠ¤ ê³„ì‚°
print(tf.nn.softmax(c))
```

    tf.Tensor(10.0, shape=(), dtype=float32)
    tf.Tensor([1 0], shape=(2,), dtype=int64)
    tf.Tensor(
    [[2.6894143e-01 7.3105854e-01]
     [9.9987662e-01 1.2339458e-04]], shape=(2, 2), dtype=float32)
    

## Shape
í…ì„œëŠ” Shapeì´ ìˆìŠµë‹ˆë‹¤.  ì‚¬ìš©ë˜ëŠ” ì¼ë¶€ ìš©ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
* Shape : í…ì„œì˜ ê° ì°¨ì›ì˜ ê¸¸ì´(ìš”ì†Œì˜ ìˆ˜)
* Rank : í…ì„œ ì¶•ì˜ ìˆ˜ ì…ë‹ˆë‹¤. ìŠ¤ì¹¼ë¼ëŠ” Rankê°€ 0ì´ê³  ë²¡í„°ì˜ RankëŠ” 1ì´ë©° í–‰ë ¬ì˜ rankëŠ” 2ì…ë‹ˆë‹¤.
* ì¶• ë˜ëŠ” ì°¨ì› : í…ì„œì˜ íŠ¹ì • ì°¨ì›
* í¬ê¸° : í…ì„œ ì´ í•­ëª© ìˆ˜, ê³± Shape ë²¡í„°

2ì°¨ì› í…ì„œì— ëŒ€í•œ ì°¸ì¡°ê°€ ìˆì„ ìˆ˜ ìˆì§€ë§Œ, Rank-2 í…ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ 2D ê³µê°„ì„ ì„¤ëª…í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

í…ì„œ ë° tf.TensorShape ê°ì²´ì—ëŠ” ë‹¤ìŒì— ì—‘ì„¸ìŠ¤í•˜ê¸° ìœ„í•œ í¸ë¦¬í•œ ì†ì„±ì´ ìˆìŠµë‹ˆë‹¤.


```python
rank_4_tensor = tf.zeros([3, 2, 4, 5])
```

![ë­í¬4.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EB%9E%AD%ED%81%AC4.PNG)


```python
print("Type of every element:", rank_4_tensor.dtype)
print("Number of dimensions:", rank_4_tensor.ndim)
print("Shape of tensor", rank_4_tensor.shape)
print("Elements along axis 0 of tensor:", rank_4_tensor.shape[0])
print("Elements along the last axis of tensor:", rank_4_tensor.shape[-1])
print("Total number of elements (3*2*4*5):", tf.size(rank_4_tensor).numpy())
```

    Type of every element: <dtype: 'float32'>
    Number of dimensions: 4
    Shape of tensor (3, 2, 4, 5)
    Elements along axis 0 of tensor: 3
    Elements along the last axis of tensor: 5
    Total number of elements (3*2*4*5): 120
    

ì¶•ì€ ì¢…ì¢… ì¸ë±ìŠ¤ë¡œ ì°¸ì¡°í•˜ì§€ë§Œ, í•­ìƒ ê° ì¶•ì˜ ì˜ë¯¸ë¥¼ ì¶”ì í•´ì•¼ í•©ë‹ˆë‹¤.  
ì¶•ì´ ì „ì—­ì—ì„œ ë¡œì»¬ë¡œ ì •ë ¬ë˜ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ìˆìŠµë‹ˆë‹¤.  
ë°°ì¹˜ ì¶•ì´ ë¨¼ì € ì˜¤ê³  ê·¸ ë‹¤ìŒì— ê³µê°„ ì°¨ì›ê³¼ ê° ìœ„ì¹˜ì˜ íŠ¹ì„±ì´ ë§ˆì§€ë§‰ì— ì˜µë‹ˆë‹¤.  
ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ íŠ¹ì„± ë²¡í„°ëŠ” ì—°ì†ì ì¸ ë©”ëª¨ë¦¬ ì˜ì—­ì…ë‹ˆë‹¤.

![ì¶•ìˆœì„œ.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EC%B6%95%EC%88%9C%EC%84%9C.PNG)



## ì¸ë±ì‹±

### ë‹¨ì¼ ì¶• ì¸ë±ì‹±
TensorFlowëŠ” íŒŒì´ì¬ì˜ ëª©ë¡ ë˜ëŠ” ë¬¸ìì—´ ì¸ë±ì‹±ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ   
í‘œì¤€ íŒŒì´ì¬ ì¸ë±ì‹± ê·œì¹™ê³¼ numpy ì¸ë±ì‹±ì˜ ê¸°ë³¸ ê·œì¹™ì„ ë”°ë¦…ë‹ˆë‹¤.
* ì¸ë±ìŠ¤ëŠ” 0ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤.
* ìŒìˆ˜ ì¸ë±ìŠ¤ëŠ” ëì—ì„œë¶€í„° ê±°ê¾¸ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.
* ì½œë¡ , :ì€ ìŠ¬ë¼ì´ìŠ¤ start:stop:stepì— ì‚¬ìš©ë©ë‹ˆë‹¤.


```python
rank_1_tensor = tf.constant([0, 1, 1, 2, 3, 5, 8, 13, 21, 34])
print(rank_1_tensor.numpy())
```

    [ 0  1  1  2  3  5  8 13 21 34]
    

ìŠ¤ì¹¼ë¼ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ë±ì‹±í•˜ë©´ ì¶•ì´ ì œê±°ë©ë‹ˆë‹¤.


```python
print("First", rank_1_tensor[0].numpy()) 
print("Second", rank_1_tensor[1].numpy())
print("Last", rank_1_tensor[-1].numpy())
```

    First 0
    Second 1
    Last 34
    

: ìŠ¬ë¼ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ë±ì‹±í•˜ë©´ ì¶•ì´ ìœ ì§€ë©ë‹ˆë‹¤. 


```python
print("Everything", rank_1_tensor[ : ].numpy())
print("Befor 4:", rank_1_tensor[ :4].numpy()) # ì²˜ìŒë¶€í„° 4ë²ˆì§¸ê¹Œì§€
print("From 4 to the end", rank_1_tensor[4: ].numpy()) # 5ë²ˆì§¸ë¶€í„° ëê¹Œì§€
print("From 2, before 7:", rank_1_tensor[2:7].numpy()) # 3ë²ˆì§¸ë¶€í„° 7ë²ˆì§¸ê¹Œì§€
print("Every other item", rank_1_tensor[::2].numpy()) #ì²˜ìŒì£¼í„° ë‘ì¹¸ì”© ê±´ë„ˆë›°ê¸°
print("Reversed:", rank_1_tensor[::-1].numpy()) # ê±°ê¾¸ë¡œ ë‚˜ì—´
```

    Everything [ 0  1  1  2  3  5  8 13 21 34]
    Befor 4: [0 1 1 2]
    From 4 to the end [ 3  5  8 13 21 34]
    From 2, before 7: [1 2 3 5 8]
    Every other item [ 0  1  3  8 21]
    Reversed: [34 21 13  8  5  3  2  1  1  0]
    

### ë‹¤ì¶• ì¸ë±ì‹±
ë” ë†’ì€ Rankì˜ í…ì„œëŠ” ì—¬ëŸ¬ ì¸ë±ìŠ¤ë¥¼ ì „ë‹¬í•˜ì—¬ ì¸ë±ì‹±ë©ë‹ˆë‹¤.

ë‹¨ì¼ ì¶•ì˜ ê²½ìš°ì—ì„œì™€ ì •í™•íˆ ê·œì¹™ì´ ê° ì¶•ì— ë…ë¦½ì ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤.


```python
print(rank_2_tensor.numpy())
```

    [[1. 2.]
     [3. 4.]
     [5. 6.]]
    

ê° ì¸ë±ìŠ¤ì— ì •ìˆ˜ë¥¼ ì „ë‹¬í•˜ë©´ ê²°ê³¼ëŠ” ìŠ¤ì¹¼ë¼ì…ë‹ˆë‹¤.


```python
print(rank_2_tensor[1, 1].numpy())
```

    4.0
    

ì •ìˆ˜ì™€ ìŠ¬ë¼ì´ìŠ¤ë¥¼ ì¡°í•©í•˜ì—¬ ì¸ë±ì‹±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
print("Second row:", rank_2_tensor[1, :].numpy()) # ë‘ë²ˆì§¸ í–‰
print("Second column:", rank_2_tensor[:, 1].numpy()) # ë‘ë²ˆì§¸ ì—´
print("Last row:", rank_2_tensor[-1, :].numpy()) # ë§ˆì§€ë§‰ í–‰
print("First item in last column:", rank_2_tensor[0, -1].numpy()) # ë‘ë²ˆì§¸ í–‰ì˜ ì²«ë²ˆì§¸ í•­ëª©
print("Skip the first row:")  # ì²«ë²ˆì§¸ í–‰ì€ ë¹¼ê³ 
print(rank_2_tensor[1 :, :].numpy(), "\n")
```

    Second row: [3. 4.]
    Second column: [2. 4. 6.]
    Last row: [5. 6.]
    First item in last column: 2.0
    Skip the first row:
    [[3. 4.]
     [5. 6.]] 
    
    

ë‹¤ìŒì€ 3ì¶• í…ì„œì˜ ì˜ˆì…ë‹ˆë‹¤.


```python
print("Everything :")
print(rank_3_tensor[:, :, :], "\n")
# 5ë²ˆì§¸ íŠ¹ì„±
print(rank_3_tensor[:, :, 4])
```

    Everything :
    tf.Tensor(
    [[[ 0  1  2  3  4]
      [ 5  6  7  8  9]]
    
     [[10 11 12 13 14]
      [15 16 17 18 19]]
    
     [[20 21 22 23 24]
      [25 26 27 28 29]]], shape=(3, 2, 5), dtype=int32) 
    
    tf.Tensor(
    [[ 4  9]
     [14 19]
     [24 29]], shape=(3, 2), dtype=int32)
    

ë°°ì¹˜ì—ì„œ ê° ì˜ˆì˜ ëª¨ë“  ìœ„ì¹˜ì—ì„œ ë§ˆì§€ë§‰ íŠ¹ì„± ì„ íƒí•˜ê¸°

![ë‹¤ì„¯ë²ˆì§¸ íŠ¹ì„±.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/5%EB%B2%88%EC%A7%B8%20%ED%8A%B9%EC%84%B1.PNG)

## Shape ì¡°ì‘í•˜ê¸°
í…ì„œì˜ Shapeì„ ë°”ê¾¸ëŠ” ê²ƒì€ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.


```python
#  Shapeì€ ê° ì°¨ì›ì˜ í¬ê¸°ë¥¼ í‘œì‹œí•˜ëŠ” 'TensorShape' ê°œì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
var_x = tf.Variable(tf.constant([[1], [2], [3]]))
print(var_x.shape)
```

    (3, 1)
    


```python
# ì´ ê°œì²´ë¥¼ íŒŒì´ì¬ ëª©ë¡ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
print(var_x.shape.as_list())
```

    [3, 1]
    

í…ì„œë¥¼ ìƒˆë¡œìš´ Shapeìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ë°ì´í„°ë¥¼ ë³µì œí•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ì¬êµ¬ì„±ì´ ë¹ ë¥´ê³  ì €ë ´í•©ë‹ˆë‹¤.


```python
# ëª©ë¡ì„ ì „ë‹¬í•œë‹¤ëŠ” ì ì— ìœ ì˜í•©ë‹ˆë‹¤.
reshaped = tf.reshape(var_x, [1,3])
```


```python
print(var_x.shape)
print(reshaped.shape)
print("var_xì˜ í˜•íƒœ :", var_x, "\n")
print("reshapedì˜ í˜•íƒœ :", reshaped)
```

    (3, 1)
    (1, 3)
    var_xì˜ í˜•íƒœ : <tf.Variable 'Variable:0' shape=(3, 1) dtype=int32, numpy=
    array([[1],
           [2],
           [3]], dtype=int32)> 
    
    reshapedì˜ í˜•íƒœ : tf.Tensor([[1 2 3]], shape=(1, 3), dtype=int32)
    

ë°ì´í„°ì˜ ë ˆì´ì•„ì›ƒì€ ë©”ëª¨ë¦¬ì—ì„œ ìœ ì§€ë˜ê³  ìš”ì²­ëœ í˜•ìƒì´ ê°™ì€ ë°ì´í„°ë¥¼ ê°€ë¦¬í‚¤ëŠ” ìƒˆ í…ì„œê°€ ì‘ì„±ë©ë‹ˆë‹¤. TensorFlowëŠ” CìŠ¤íƒ€ì¼ " í–‰ ì¤‘ì‹¬" ë©”ëª¨ë¦¬ ìˆœì„œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ ê°€ì¥ ì˜¤ë¥¸ìª½ì— ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ì¦ê°€ì‹œí‚¤ë©´ ë©”ëª¨ë¦¬ì˜ ë‹¨ì¼ ë‹¨ê³„ì— í•´ë‹¹í•©ë‹ˆë‹¤.


```python
print(rank_3_tensor)
```

    tf.Tensor(
    [[[ 0  1  2  3  4]
      [ 5  6  7  8  9]]
    
     [[10 11 12 13 14]
      [15 16 17 18 19]]
    
     [[20 21 22 23 24]
      [25 26 27 28 29]]], shape=(3, 2, 5), dtype=int32)
    

í…ì„œë¥¼ í‰í‰í•˜ê²Œ í•˜ë©´ ì–´ë–¤ ìˆœì„œë¡œ ë©”ëª¨ë¦¬ì— ë°°ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
print(tf.reshape(rank_3_tensor, [-1]))
```

    tf.Tensor(
    [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
     24 25 26 27 28 29], shape=(30,), dtype=int32)
    

ì¼ë°˜ì ìœ¼ë¡œ tf.reshapeì˜ í•©ë¦¬ì ì¸ ìš©ë„ëŠ” ì¸ì ‘í•œ ì¶•ì„ ê²°í•©í•˜ê±°ë‚˜ ë¶„í• í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì´ 3x2x5 í…ì„œì˜ ê²½ìš°, ìŠ¬ë¼ì´ìŠ¤ê°€ í˜¼í•©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ (3x2)x5 ë˜ëŠ” 3x(2x5)ë¡œ ì¬ìˆ˜ì„±í•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ì…ë‹ˆë‹¤.


```python
print(tf.reshape(rank_3_tensor, [3*2, 5]), "\n")
print(tf.reshape(rank_3_tensor, [3, -1]))
```

    tf.Tensor(
    [[ 0  1  2  3  4]
     [ 5  6  7  8  9]
     [10 11 12 13 14]
     [15 16 17 18 19]
     [20 21 22 23 24]
     [25 26 27 28 29]], shape=(6, 5), dtype=int32) 
    
    tf.Tensor(
    [[ 0  1  2  3  4  5  6  7  8  9]
     [10 11 12 13 14 15 16 17 18 19]
     [20 21 22 23 24 25 26 27 28 29]], shape=(3, 10), dtype=int32)
    

![ì¬êµ¬ì„±.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EC%9E%AC%EA%B5%AC%EC%84%B1.PNG)

Shapeì„ ë³€ê²½í•˜ë©´ ê°™ì€ ì´ ìš”ì†Œ ìˆ˜ë¥¼ ê°€ì§„ ìƒˆë¡œìš´ Shapeì— ëŒ€í•´ "ì‘ë™"í•˜ì§€ë§Œ, ì¶•ì˜ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì§€ ì•Šìœ¼ë©´ ë³„ë¡œ ì“¸ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.

tf.reshapeì—ì„œ ì¶• êµí™˜ì´ ì‘ë™í•˜ì§€ ì•Šìœ¼ë©´, tf.transposeë¥¼ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.


```python
# í•˜ì§€ë§ì•„ì•¼ í•˜ëŠ” ê²½ìš°
# ëª¨ì–‘ì„ ë³€ê²½í•  ë•Œ ì¶•ì„ ë‹¤ì‹œ ì •ë ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
print(tf.reshape(rank_3_tensor, [2, 3, 5]), "\n")

print(tf.reshape(rank_3_tensor, [5,6]), "\n")

try:
  tf.reshape(rank_3_tensor, [7, -1])
except Exception as e:
  print(f"{type(e).__name__}: {e}")
```

    tf.Tensor(
    [[[ 0  1  2  3  4]
      [ 5  6  7  8  9]
      [10 11 12 13 14]]
    
     [[15 16 17 18 19]
      [20 21 22 23 24]
      [25 26 27 28 29]]], shape=(2, 3, 5), dtype=int32) 
    
    tf.Tensor(
    [[ 0  1  2  3  4  5]
     [ 6  7  8  9 10 11]
     [12 13 14 15 16 17]
     [18 19 20 21 22 23]
     [24 25 26 27 28 29]], shape=(5, 6), dtype=int32) 
    
    InvalidArgumentError: Input to reshape is a tensor with 30 values, but the requested shape requires a multiple of 7 [Op:Reshape]
    

![ì˜ëª»ëœ ì˜ˆ.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EC%9E%98%EB%AA%BB%EB%90%9C%20%EC%98%88.PNG)

## DTypesì— ëŒ€í•œ ì¶”ê°€ ì •ë³´
tf.Tensorì˜ ë°ì´í„° ìœ í˜•ì„ ê²€ì‚¬í•˜ë ¤ë©´, Tensor.dtype ì†ì„±ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

Python ê°ì²´ì—ì„œ tf.Tensorë¥¼ ë§Œë“¤ ë•Œ ì„ íƒì ìœ¼ë¡œ ë°ì´í„° ìœ í˜•ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë ‡ì§€ ì•Šìœ¼ë©´, TensorFlowëŠ” ë°ì´í„°ë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ë°ì´í„° ìœ í˜•ì„ ì„ íƒí•©ë‹ˆë‹¤. TensorFlowëŠ” Python ì •ìˆ˜ë¥¼ tf.int32ë¡œ, Python ë¶€ë™ ì†Œìˆ˜ì  ìˆ«ìë¥¼ tf.float32ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´, TensorFlowëŠ” NumPyê°€ ë°°ì—´ë¡œ ë³€í™˜í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ê·œì¹™ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ìœ í˜•ë³„ë¡œ ìºìŠ¤íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤,


```python
the_f64_tensor = tf.constant([2.2, 3.3, 4.4], dtype=tf.float64)
the_f16_tensor = tf.cast(the_f64_tensor, dtype=tf.float16)
the_u8_tensor = tf.cast(the_f16_tensor, dtype=tf.uint8)
print(the_f64_tensor)
print(the_f16_tensor)
print(the_u8_tensor)
```

    tf.Tensor([2.2 3.3 4.4], shape=(3,), dtype=float64)
    tf.Tensor([2.2 3.3 4.4], shape=(3,), dtype=float16)
    tf.Tensor([2 3 4], shape=(3,), dtype=uint8)
    

## ë¸Œë¡œë“œìºìŠ¤íŒ…
ë¸Œë¡œë“œìºìŠ¤íŒ…ì€ NumPyì˜ ë¸Œë¡œë“œìºìŠ¤íŒ… íŠ¹ì„±ì—ì„œ ë¹Œë¦° ê°œë…ì…ë‹ˆë‹¤. íŠ¹ì • ì¡°ê±´ì—ì„œ ì‘ì€ í…ì„œëŠ” ê²°í™˜ëœ ì—°ì‚°ì„ ì‹¤í–‰í•  ë•Œ ë” í° í…ì„œì— ë§ê²Œ ìë™ìœ¼ë¡œ í™•ì¥ ë©ë‹ˆë‹¤.

ê°€ì¥ ê°„ë‹¨í•˜ê³  ì¼ë°˜ì ì¸ ê²½ìš°ëŠ” ìŠ¤ì¹¼ë¼ì— í…ì„œë¥¼ ê³±í•˜ê±°ë‚˜ ì¶”ê°€í•˜ë ¤ê³  í•  ë•Œ ì…ë‹ˆë‹¤. ì´ ê²½ìš°, ìŠ¤ì¹¼ë¼ëŠ ã„´ë‹¤ë¥¸ ì¸ìˆ˜ì™€ ê°™ì€ í˜•ìƒìœ¼ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë©ë‹ˆë‹¤.


```python
x = tf.constant([1, 2, 3])

y = tf.constant(2)
z = tf.constant([2, 2, 2])

#ì•„ë˜ ì„¸ê°€ì§€ëŠ” ë‹¤ ê°™ì€ ê³„ì‚°ì´ë‹¤.
print(tf.multiply(x, 2))
print(x * y)
print(x * z)
```

    tf.Tensor([2 4 6], shape=(3,), dtype=int32)
    tf.Tensor([2 4 6], shape=(3,), dtype=int32)
    tf.Tensor([2 4 6], shape=(3,), dtype=int32)
    

ë§ˆì°¬ê°€ì§€ë¡œ, í¬ê¸°ê°€ 1ì¸ ì¶•ì€ ë‹¤ë¥¸ ì¸ìˆ˜ì™€ ì¼ì¹˜í•˜ë„ë¡ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‘ ì¸ìˆ˜ ëª¨ë‘ ê°™ì€ ê³„ì‚°ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ê²½ìš°, 3x1 í–‰ë ¬ì— ìš”ì†Œë³„ë¡œ 1x4 í–‰ë ¬ì„ ê³±í•˜ì—¬ 3x4í–‰ë ¬ì„ ë§Œë“­ë‹ˆë‹¤. ì„ í–‰ 1ì´ ì„ íƒì‚¬í•­ ì…ë‹ˆë‹¤. yì˜ shapeì€ [4]ì…ë‹ˆë‹¤.


```python
x = tf.reshape(x, [3,1])
y = tf.range(1, 5)
print(x, "\n")
print(y, "\n")
print(tf.multiply(x, y))
```

    tf.Tensor(
    [[1]
     [2]
     [3]], shape=(3, 1), dtype=int32) 
    
    tf.Tensor([1 2 3 4], shape=(4,), dtype=int32) 
    
    tf.Tensor(
    [[ 1  2  3  4]
     [ 2  4  6  8]
     [ 3  6  9 12]], shape=(3, 4), dtype=int32)
    

![3x4.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/3x4.PNG)

ë¸Œë¡œë“œìºìŠ¤íŒ…ì„ ì•ˆì“´ ì—°ì‚°


```python
x_stretch = tf.constant([[1, 1, 1, 1],
                         [2, 2, 2, 2],
                         [3, 3, 3, 3]])

y_stretch = tf.constant([[1, 2, 3, 4],
                         [1, 2, 3, 4],
                         [1, 2, 3, 4]])

print(x_stretch * y_stretch)
```

    tf.Tensor(
    [[ 1  2  3  4]
     [ 2  4  6  8]
     [ 3  6  9 12]], shape=(3, 4), dtype=int32)
    

ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë¸Œë¡œë“œìºìŠ¤íŒ…ì€ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì—°ì‚°ìœ¼ë¡œ ë©”ëª¨ë¦¬ì—ì„œ í™•ì •ëœ í…ì„œë¥¼ êµ¬ì²´í™”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‹œê°„ê³¼ ê³µê°„ì ìœ¼ë¡œ íš¨ìœ¨ì ì…ë‹ˆë‹¤.


```python
print(tf.broadcast_to(tf.constant([1, 2, 3]), [3, 3]))
```

    tf.Tensor(
    [[1 2 3]
     [1 2 3]
     [1 2 3]], shape=(3, 3), dtype=int32)
    

## ë¹„ì •í˜• í…ì„œ
ì¼ë¶€ ì¶•ì„ ë”°ë¼ ìš”ì†Œì˜ ìˆ˜ê°€ ê°€ë³€ì ì¸ í…ì„œë¥¼ "ë¹„ì •í˜•"ì´ë¼ê³  í•œë‹¤. tf.raggedë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 

ë¹„ì •í˜• ë°ì´í„°ë¥¼ ìœ„í•´ì„œ tf.ragged.RageedTensorë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ ê·¸ë¦¼ì€ ì •ê·œ í…ì„œë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

![ë¹„ì •í˜•.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EB%B9%84%EC%A0%95%ED%98%95.PNG)




```python
ragged_list = [[0, 1, 2, 3],
               [4, 5],
               [6, 7, 8],
               [9]]
```


```python
try:
  tensor = tf.constant(ragged_list)
except Exception as e:
  print(f"{type(e).__name__} : {e}")
```

    ValueError : Can't convert non-rectangular Python sequence to Tensor.
    

ëŒ€ì‹ ì— tf.ragged.constantë¥¼ ì‚¬ìš©í•˜ëŠ” tf.RaggedTensorë¥¼ ë§Œë“­ë‹ˆë‹¤.


```python
ragged_tensor = tf.ragged.constant(ragged_list)
print(ragged_tensor)
```

    <tf.RaggedTensor [[0, 1, 2, 3], [4, 5], [6, 7, 8], [9]]>
    

tf.RaggedTensorì˜ ëª¨ì–‘ì€ ì•Œìˆ˜ ì—†ëŠ” ê¸¸ì´ì˜ ì¼ë¶€ ì¶•ì´ í¬í•©ë©ë‹ˆë‹¤.


```python
print(ragged_tensor.shape)
```

    (4, None)
    

## ë¬¸ìì—´ í…ì„œ
tf.stringì€ dtypeì´ë©°, í…ì„œì—ì„œ ë¬¸ìì—´(ê°€ë³€ ê¸¸ì´ì˜ ë°”ì´íŠ¸ ë°°ì—´)ê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ë‚˜íƒ€ë‚¼ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¬¸ìì—´ì€ ì›ìì„±ì´ë¯€ë¡œ Python ë¬¸ìì—´ê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì¸ë±ì‹±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¬¸ìì—´ì˜ ê¸¸ì´ëŠ” í…ì„œì˜ ì¶• ì¤‘ì˜ í•˜ë‚˜ê°€ ì•„ë‹™ë‹ˆë‹¤.

ë‹¤ìŒì€ ìŠ¤ì¹¼ë¼ ë¬¸ìì—´ í…ì„œì…ë‹ˆë‹¤.


```python
scalar_string_tensor = tf.constant("Gray wolf")
print(scalar_string_tensor)
```

    tf.Tensor(b'Gray wolf', shape=(), dtype=string)
    

ë¬¸ìì—´ì˜ ë²¡í„°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![ë¬¸ìì—´ë°±í„°.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EB%AC%B8%EC%9E%90%EC%97%B4%20%EB%B0%B1%ED%84%B0.PNG)


```python
# ê¸¸ì´ê°€ ë‹¤ë¥¸ ë¬¸ìì—´ í…ì„œê°€ ì„¸ ê°œ ìˆìœ¼ë©´ ê´œì°®ìŠµë‹ˆë‹¤.
tensor_of_strings = tf.constant(["Gray wolf",
                                 "Quick brown fox",
                                 "Lazy dog"])
# Shapeì€ (3)ì…ë‹ˆë‹¤. ë¬¸ìì—´ ê¸¸ì´ê°€ í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
print(tensor_of_strings)
```

    tf.Tensor([b'Gray wolf' b'Quick brown fox' b'Lazy dog'], shape=(3,), dtype=string)
    

ìœ„ì˜ ì¶œë ¥ì—ì„œ bì ‘ë‘ì‚¬ëŠ” tf.string dtypeì´ ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì´ ì•„ë‹ˆë¼ ë°”ì´íŠ¸ ë¬¸ìì—´ì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

ìœ ë‹ˆì½”ë“œ ë¬¸ìë¥¼ ì „ë‹¬í•˜ë©´ UTF-8ë¡œ ì¸ì½”ë”©ë©ë‹ˆë‹¤.



```python
tf.constant("ğŸ¥³ğŸ‘")
```




    <tf.Tensor: shape=(), dtype=string, numpy=b'\xf0\x9f\xa5\xb3\xf0\x9f\x91\x8d'>



ë¬¸ìì—´ì´ ìˆëŠ” ì¼ë¶€ ê¸°ë³¸ í•¨ìˆ˜ëŠ” tf.stringsì„ í¬í•¨í•˜ì—¬ tf.strings.splitì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
# splitì„ ì‚¬ìš©í•˜ì—¬ stringì„ í…ì„œ ì„¸íŠ¸ë¡œ ë¶„í• í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
print(tf.strings.split(scalar_string_tensor, sep= " "))
```

    tf.Tensor([b'Gray' b'wolf'], shape=(2,), dtype=string)
    


```python
# í•˜ì§€ë§Œ stringìœ¼ë¡œ ëœ í…ì„œë¥¼ ë‚˜ëˆ„ë©´ ë¹„ì •í˜• í…ì„œê°€ ë©ë‹ˆë‹¤.
# ê° ë¬¸ìì—´ì´ ì„œë¡œ ë‹¤ë¥¸ ìˆ˜ì˜ íŒŒíŠ¸ë¡œ ë¶„í• ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
print(tf.strings.split(tensor_of_strings))
```

    <tf.RaggedTensor [[b'Gray', b'wolf'], [b'Quick', b'brown', b'fox'], [b'Lazy', b'dog']]>
    

![ë¬¸ìì—´ ë¹„ì •í˜•.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%EB%AC%B8%EC%9E%90%EC%97%B4%20%EB%B9%84%EC%A0%95%ED%98%95.PNG)

tf.string.to_number:


```python
text = tf.constant("1 10 100")
print(tf.strings.to_number(tf.strings.split(text, " ")))
```

    tf.Tensor([  1.  10. 100.], shape=(3,), dtype=float32)
    

tf.castë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìì—´ í…ì„œë¥¼ ìˆ«ìë¡œ ë³€í™˜í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, ë°”ì´íŠ¸ë¡œ ë³€í™˜í•œ ë‹¤ìŒ ìˆ«ìë¡œ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 


```python
byte_strings = tf.strings.bytes_split(tf.constant("Duck")) # "Duck"ì„ ë°”ì´íŠ¸ë¡œ ë¶„í• 
byte_ints = tf.io.decode_raw(tf.constant("Duck"), tf.uint8) # ìˆ«ìë¡œ ë³€í™˜
print("Byte strings:", byte_strings)
print("Bytes:", byte_ints)
```

    Byte strings: tf.Tensor([b'D' b'u' b'c' b'k'], shape=(4,), dtype=string)
    Bytes: tf.Tensor([ 68 117  99 107], shape=(4,), dtype=uint8)
    


```python
# ë˜ëŠ” ìœ ë‹ˆì½”ë“œë¡œ ë¶„í• í•˜ì—¬ ë””ì½”ë”©í•©ë‹ˆë‹¤.
unicode_bytes = tf.constant("í•œê¸€ ğŸ¦†")
unicode_char_bytes = tf.strings.unicode_split(unicode_bytes, "UTF-8")
unicode_values = tf.strings.unicode_decode(unicode_bytes, "UTF-8")

print("\nUnicode bytes:", unicode_bytes)
print("\nUnicode chars:", unicode_char_bytes)
print("\nUnicode values:", unicode_values)
```

    
    Unicode bytes: tf.Tensor(b'\xed\x95\x9c\xea\xb8\x80 \xf0\x9f\xa6\x86', shape=(), dtype=string)
    
    Unicode chars: tf.Tensor([b'\xed\x95\x9c' b'\xea\xb8\x80' b' ' b'\xf0\x9f\xa6\x86'], shape=(4,), dtype=string)
    
    Unicode values: tf.Tensor([ 54620  44544     32 129414], shape=(4,), dtype=int32)
    

tf.string dtypeì€ TensorFlowì˜ ëª¨ë“  ì›ì‹œ ë°”ì´íŠ¸ ë°ì´í„°ì— ì‚¬ìš©ë©ë‹ˆë‹¤. tf.io ëª¨ë“ˆì—ëŠ” ì´ë° ë””ì½”ë”© ë° csvêµ¬ë¬¸ ë¶„ì„ì„ í¬í•¨í•˜ì—¬ ë°ì´í„°ë¥¼ ë°”ì´íŠ¸ë¡œ ë³€í™˜í•˜ê±°ë‚˜ ë°”ì´íŠ¸ì—ì„œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## í¬ì†Œ í…ì„œ
ë•Œë•Œë¡œ ë°ì´í„°ëŠ” ë§¤ìš° ë„“ì€ ì„ë² ë”© ê³µê°„ì²˜ëŸ¼ í¬ì†Œí•©ë‹ˆë‹¤. TensorFlowëŠ” tf.sparseì™€ í¬ì†Œ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•œ ê´€ë ¨ ì‘ì—…ë“¤ì„ ì§€ì›í•©ë‹ˆë‹¤.

ì„ë² ë”© : ìì—°ì–´ ì²˜ë¦¬ ë¶„ì•¼ì—ì„œ ì‚¬ëŒì´ ì“°ëŠ” ìì—°ì–´ë¥¼ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ìˆ«ìí˜•íƒœì¸ vectorë¡œ ë°”ê¾¼ ê²°ê³¼ í˜¹ì€ ê·¸ ì¼ë ¨ì˜ ê³¼ì • ì „ì²´

![í¬ì†Œ.png](https://raw.githubusercontent.com/jaehyun0306/jaehyun0306/main/%ED%9D%AC%EC%86%8C.PNG)


```python
sparse_tensor = tf.sparse.SparseTensor(indices=[[0, 0], [1, 2]],
                                       values=[1, 2],
                                       dense_shape=[3, 4])
print(sparse_tensor, "\n")

print(tf.sparse.to_dense(sparse_tensor))
```

    SparseTensor(indices=tf.Tensor(
    [[0 0]
     [1 2]], shape=(2, 2), dtype=int64), values=tf.Tensor([1 2], shape=(2,), dtype=int32), dense_shape=tf.Tensor([3 4], shape=(2,), dtype=int64)) 
    
    tf.Tensor(
    [[1 0 0 0]
     [0 0 2 0]
     [0 0 0 0]], shape=(3, 4), dtype=int32)
    
